SELECT CUSTOMER_ID, count(*) AS COUNT_NO_TRANS
FROM VISITS V
LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID
WHERE TRANSACTION_ID IS NULL
group by CUSTOMER_ID;
